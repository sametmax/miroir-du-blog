<?xml version="1.0" encoding="UTF-8"?><rss version="2.0"
	xmlns:content="http://purl.org/rss/1.0/modules/content/"
	xmlns:wfw="http://wellformedweb.org/CommentAPI/"
	xmlns:dc="http://purl.org/dc/elements/1.1/"
	xmlns:atom="http://www.w3.org/2005/Atom"
	xmlns:sy="http://purl.org/rss/1.0/modules/syndication/"
	xmlns:slash="http://purl.org/rss/1.0/modules/slash/"
	>

<channel>
	<title>Sam &#38; Max &#187; debug</title>
	<atom:link href="http://sametmax.com/tag/debug/feed/" rel="self" type="application/rss+xml" />
	<link>http://sametmax.com</link>
	<description>Du code, du cul</description>
	<lastBuildDate>Sat, 07 Nov 2015 10:56:13 +0000</lastBuildDate>
	<language>en-US</language>
	<sy:updatePeriod>hourly</sy:updatePeriod>
	<sy:updateFrequency>1</sy:updateFrequency>
	<generator>http://wordpress.org/?v=4.1</generator>
	<item>
		<title>Breakpoint conditionnels 3</title>
		<link>http://sametmax.com/breakpoint-conditionnels/</link>
		<comments>http://sametmax.com/breakpoint-conditionnels/#comments</comments>
		<pubDate>Wed, 04 Nov 2015 06:56:11 +0000</pubDate>
		<dc:creator><![CDATA[Sam]]></dc:creator>
				<category><![CDATA[Programmation]]></category>
		<category><![CDATA[debug]]></category>
		<category><![CDATA[pdb]]></category>
		<category><![CDATA[python]]></category>

		<guid isPermaLink="false">http://sametmax.com/?p=16993</guid>
		<description><![CDATA[Quand vous lancez pdb, il est parfois intéressant stopper le programme à un endroit donné sous une certaine condition. ]]></description>
				<content:encoded><![CDATA[<p>Quand vous lancez pdb, il est parfois intéressant stopper le programme à un endroit donné sous une certaine condition. En cela, on peut utiliser un if:</p>

<div class="wp_syntax"><table><tr><td class="code"><pre class="python" style="font-family:monospace;"><span style="color: #ff7700;font-weight:bold;">if</span> truc:
    <span style="color: #ff7700;font-weight:bold;">import</span> <span style="color: #dc143c;">pdb</span><span style="color: #66cc66;">;</span> <span style="color: #dc143c;">pdb</span>.<span style="color: black;">set_trace</span><span style="color: black;">&#40;</span><span style="color: black;">&#41;</span></pre></td></tr></table></div>

<p>Mais il est aussi possible de le faire pendant qu&#8217;on est en train d&#8217;utiliser le debugger grace à la commande &#8220;b&#8221; :</p>
<p><code>b 50, age == 18</code></p>
<p>Ceci va mettre un breakpoint à la ligne 50 qui s&#8217;activera uniquement si age vaut 18.</p>
<p>Des fois que ça serve&#8230;</p>
]]></content:encoded>
			<wfw:commentRss>http://sametmax.com/breakpoint-conditionnels/feed/</wfw:commentRss>
		<slash:comments>3</slash:comments>
	<enclosure url="http://sametmax.com/wp-content/uploads/2015/11/tumblr_nuz50aDL1F1r539hzo1_500.jpg" length="61930" type="image/jpg" />	</item>
		<item>
		<title>Le debug par la force du Q 4</title>
		<link>http://sametmax.com/le-debug-par-la-force-du-q/</link>
		<comments>http://sametmax.com/le-debug-par-la-force-du-q/#comments</comments>
		<pubDate>Sun, 04 Oct 2015 12:37:49 +0000</pubDate>
		<dc:creator><![CDATA[Sam]]></dc:creator>
				<category><![CDATA[Programmation]]></category>
		<category><![CDATA[debug]]></category>
		<category><![CDATA[python]]></category>

		<guid isPermaLink="false">http://sametmax.com/?p=16944</guid>
		<description><![CDATA[D'abord ça commence avec des <code>print()</code> puis du <a href="http://sametmax.com/debugger-en-python-les-bases-de-pdb/">pdb</a>... Puis le code se retrouve dans en background, ou on a des threads, des sous-processes, des proxies, son serveur WSGI qui tourne, etc. Et là, il faut sortir les outils de logging, la massue, le truc qui demande 3 ans à config.]]></description>
				<content:encoded><![CDATA[<p>D’abord ça commence avec des <code>print()</code> puis du <a href="http://sametmax.com/debugger-en-python-les-bases-de-pdb/">pdb</a>&#8230; Puis le code se retrouve en background, ou on a des threads, des sous-processes, des proxies, son serveur WSGI qui tourne, etc. Et là, il faut sortir les outils de logging, la massue, le truc qui demande 3 ans à config.</p>
<p>Il n’y a pas de juste milieu.</p>
<p>Alors un mec nous a donné son <a href="https://github.com/zestyping/q">Q</a> pour changer tout ça.</p>
<pre>pip install q</pre>
<p>Q est typiquement un lib de feignasse :</p>

<div class="wp_syntax"><table><tr><td class="code"><pre class="python" style="font-family:monospace;"><span style="color: #ff7700;font-weight:bold;">def</span> bip<span style="color: black;">&#40;</span><span style="color: black;">&#41;</span>:
    a <span style="color: #66cc66;">=</span> <span style="color: #ff4500;">1</span>
&nbsp;
    <span style="color: #ff7700;font-weight:bold;">import</span> q
    q<span style="color: black;">&#40;</span>a<span style="color: black;">&#41;</span>
    q<span style="color: black;">&#40;</span>a + <span style="color: #ff4500;">1</span><span style="color: black;">&#41;</span>
&nbsp;
bip<span style="color: black;">&#40;</span><span style="color: black;">&#41;</span></pre></td></tr></table></div>

<p>Et pouf, tout est loggé dans <code>/tmp/q </code>:</p>
<pre>
     0.0s bip: a=1
     0.0s bip: a + 1=2
</pre>
<p>On peut aussi l’utiliser en décorateur pour tracer l’exécution d’une fonction :</p>

<div class="wp_syntax"><table><tr><td class="code"><pre class="python" style="font-family:monospace;"><span style="color: #ff7700;font-weight:bold;">import</span> q
&nbsp;
<span style="color: #66cc66;">@</span>q
<span style="color: #ff7700;font-weight:bold;">def</span> bip<span style="color: black;">&#40;</span><span style="color: black;">&#41;</span>:
    a <span style="color: #66cc66;">=</span> <span style="color: #ff4500;">1</span>
bip<span style="color: black;">&#40;</span><span style="color: black;">&#41;</span></pre></td></tr></table></div>

<p>Ce qui donne :</p>
<pre>
 0.0s bip()
 0.0s -> None
</pre>
<p>Ce n’est bien entendu pas fait pour être laissé dans le code, mais uniquement pour le debug. Néamoins c’est fort pratique :</p>
<ul>
<li>Le fichier de log est setup automatiquement. On peut quand même choisir le dossier avec la variable d’environnement <code> $TMPDIR</code></li>
<li>Le contenu de l’expression est logguée magiquement avec le résultat.</li>
<li>En prime on a le temps d’exécution.</li>
<li>Le fichier de sortie contient de la coloration syntaxique, s’il vous plait !</li>
</ul>
<p>Avec <a href="https://github.com/karan/joe">Joe</a>, qui génère des .gitignores, c’est ma petite découverte sympa de la rentrée.</p>
]]></content:encoded>
			<wfw:commentRss>http://sametmax.com/le-debug-par-la-force-du-q/feed/</wfw:commentRss>
		<slash:comments>4</slash:comments>
	<enclosure url="http://sametmax.com/wp-content/uploads/2015/10/fessesimages.jpg" length="7163" type="image/jpg" />	</item>
		<item>
		<title>Lancer pdb dès qu&#8217;une exception a lieu 9</title>
		<link>http://sametmax.com/lancer-pdb-des-quune-exception-a-lieu/</link>
		<comments>http://sametmax.com/lancer-pdb-des-quune-exception-a-lieu/#comments</comments>
		<pubDate>Fri, 10 Apr 2015 10:08:23 +0000</pubDate>
		<dc:creator><![CDATA[Sam]]></dc:creator>
				<category><![CDATA[Programmation]]></category>
		<category><![CDATA[debug]]></category>
		<category><![CDATA[exception]]></category>
		<category><![CDATA[pdb]]></category>
		<category><![CDATA[python]]></category>

		<guid isPermaLink="false">http://sametmax.com/?p=16055</guid>
		<description><![CDATA[Vous vous souvenez de excepthook et de pdb ? Mélangeons les deux ! &#160; import sys import traceback import pdb &#160; def pdb_post_mortem&#40;exc_type, exc_val, exc_tb&#41;: # On affiche l'exception histoire de savoir ce qu'on debug print&#40;&#34;&#34;.join&#40;traceback.format_exception&#40;exc_type, exc_val, exc_tb&#41;&#41;&#41; # On balance pdb en mode post mortem, c'est à dire qu'il va se lancer # malgré [&#8230;]]]></description>
				<content:encoded><![CDATA[<p>Vous vous souvenez de <a href="http://sametmax.com/gestion-des-erreurs-en-python/">excepthook</a> et de <a href="http://sametmax.com/debugger-en-python-les-bases-de-pdb/">pdb</a> ?</p>
<p>Mélangeons les deux !</p>

<div class="wp_syntax"><table><tr><td class="code"><pre class="python" style="font-family:monospace;">&nbsp;
<span style="color: #ff7700;font-weight:bold;">import</span> <span style="color: #dc143c;">sys</span>
<span style="color: #ff7700;font-weight:bold;">import</span> <span style="color: #dc143c;">traceback</span>
<span style="color: #ff7700;font-weight:bold;">import</span> <span style="color: #dc143c;">pdb</span>
&nbsp;
<span style="color: #ff7700;font-weight:bold;">def</span> pdb_post_mortem<span style="color: black;">&#40;</span>exc_type<span style="color: #66cc66;">,</span> exc_val<span style="color: #66cc66;">,</span> exc_tb<span style="color: black;">&#41;</span>:
    <span style="color: #808080; font-style: italic;"># On affiche l'exception histoire de savoir ce qu'on debug</span>
    <span style="color: #ff7700;font-weight:bold;">print</span><span style="color: black;">&#40;</span><span style="color: #483d8b;">&quot;&quot;</span>.<span style="color: black;">join</span><span style="color: black;">&#40;</span><span style="color: #dc143c;">traceback</span>.<span style="color: black;">format_exception</span><span style="color: black;">&#40;</span>exc_type<span style="color: #66cc66;">,</span> exc_val<span style="color: #66cc66;">,</span> exc_tb<span style="color: black;">&#41;</span><span style="color: black;">&#41;</span><span style="color: black;">&#41;</span>
    <span style="color: #808080; font-style: italic;"># On balance pdb en mode post mortem, c'est à dire qu'il va se lancer</span>
    <span style="color: #808080; font-style: italic;"># malgré le fait que le programme ne marche plus, donnant accès</span>
    <span style="color: #808080; font-style: italic;"># au contexte qu'il y avait juste avant que ça foire</span>
    <span style="color: #dc143c;">pdb</span>.<span style="color: black;">post_mortem</span><span style="color: black;">&#40;</span>exc_tb<span style="color: black;">&#41;</span>
&nbsp;
<span style="color: #808080; font-style: italic;"># On dit à python de lancer cette fonction quand il plante</span>
<span style="color: #dc143c;">sys</span>.<span style="color: black;">excepthook</span> <span style="color: #66cc66;">=</span> pdb_post_mortem
&nbsp;
<span style="color: #808080; font-style: italic;"># On fait planter Python histoire de voir que ça marche bien</span>
&nbsp;
<span style="color: #ff7700;font-weight:bold;">def</span> boom<span style="color: black;">&#40;</span><span style="color: black;">&#41;</span>:
    a <span style="color: #66cc66;">=</span> <span style="color: #ff4500;">1</span>
    b <span style="color: #66cc66;">=</span> a / <span style="color: #ff4500;">0</span>
boom<span style="color: black;">&#40;</span><span style="color: black;">&#41;</span></pre></td></tr></table></div>

<p>Et si quand ça plante, Python nous pond la stack trace, puis nous lance un joli prompt de debugging qui donne accès à ce qu&#8217;on avait en mémoire just avant que la VM ne décède :</p>
<pre>Traceback (most recent call last):
  File "test.py", line 16, in <module>
    boom()
  File "test.py", line 14, in boom
    b = a / 0
ZeroDivisionError: integer division or modulo by zero

> /home/sam/Bureau/test.py(14)test()
-> a = 1 / 0
(Pdb) 1
(Pdb) print a
1</pre>
<p>C&#8217;est plus ou moins l&#8217;équivalent de lancer son programme manuellement avec :</p>

<div class="wp_syntax"><table><tr><td class="code"><pre class="bash" style="font-family:monospace;">python <span style="color: #660033;">-m</span> pdb programme.py</pre></td></tr></table></div>

<p>L&#8217;avantage de la première forme, c&#8217;est qu&#8217;on peut le setter et l&#8217;oublier, on faire une config un peu plus custom. L&#8217;avantage de la deuxième forme, c&#8217;est que c&#8217;est juste une ligne à taper, et en prime si on fait <code>c</code>, le programme redémarre automatiquement.</p>
]]></content:encoded>
			<wfw:commentRss>http://sametmax.com/lancer-pdb-des-quune-exception-a-lieu/feed/</wfw:commentRss>
		<slash:comments>9</slash:comments>
	<enclosure url="http://sametmax.com/wp-content/uploads/2015/04/zg1kTnr.jpg" length="44727" type="image/jpg" />	</item>
		<item>
		<title>Mettre automatiquement DEBUG sur False en production pour Django 2</title>
		<link>http://sametmax.com/mettre-automatiquement-debug-sur-false-en-production-pour-django/</link>
		<comments>http://sametmax.com/mettre-automatiquement-debug-sur-false-en-production-pour-django/#comments</comments>
		<pubDate>Sat, 01 Sep 2012 14:24:22 +0000</pubDate>
		<dc:creator><![CDATA[Sam]]></dc:creator>
				<category><![CDATA[Programmation]]></category>
		<category><![CDATA[debug]]></category>
		<category><![CDATA[deploiement]]></category>
		<category><![CDATA[django]]></category>
		<category><![CDATA[python]]></category>
		<category><![CDATA[settings]]></category>

		<guid isPermaLink="false">http://sametmax.com/?p=1913</guid>
		<description><![CDATA[L'avantage des fichiers de settings en pur Python, c'est qu'on peut faire des trucs mignons comme ça....]]></description>
				<content:encoded><![CDATA[<p>L&#8217;avantage des fichiers de settings en pur Python, c&#8217;est qu&#8217;on peut faire des trucs mignons comme:</p>

<div class="wp_syntax"><table><tr><td class="code"><pre class="python" style="font-family:monospace;"><span style="color: #ff7700;font-weight:bold;">import</span> <span style="color: #dc143c;">socket</span>
&nbsp;
<span style="color: #ff7700;font-weight:bold;">if</span> <span style="color: #dc143c;">socket</span>.<span style="color: black;">gethostname</span><span style="color: black;">&#40;</span><span style="color: black;">&#41;</span> <span style="color: #66cc66;">==</span> <span style="color: #483d8b;">'monsupersite.com'</span>:
    DEBUG <span style="color: #66cc66;">=</span> <span style="color: #008000;">False</span>
<span style="color: #ff7700;font-weight:bold;">else</span>:
    DEBUG <span style="color: #66cc66;">=</span> <span style="color: #008000;">True</span></pre></td></tr></table></div>

]]></content:encoded>
			<wfw:commentRss>http://sametmax.com/mettre-automatiquement-debug-sur-false-en-production-pour-django/feed/</wfw:commentRss>
		<slash:comments>2</slash:comments>
	<enclosure url="http://sametmax.com/wp-content/uploads/2012/08/miss-post-it.jpg" length="50732" type="image/jpg" />	</item>
		<item>
		<title>Debugger en Python: les bases de pdb 4</title>
		<link>http://sametmax.com/debugger-en-python-les-bases-de-pdb/</link>
		<comments>http://sametmax.com/debugger-en-python-les-bases-de-pdb/#comments</comments>
		<pubDate>Sun, 27 May 2012 04:40:05 +0000</pubDate>
		<dc:creator><![CDATA[Sam]]></dc:creator>
				<category><![CDATA[Programmation]]></category>
		<category><![CDATA[debug]]></category>
		<category><![CDATA[ipdb]]></category>
		<category><![CDATA[ipython]]></category>
		<category><![CDATA[pdb]]></category>
		<category><![CDATA[python]]></category>

		<guid isPermaLink="false">http://sametmax.com/?p=750</guid>
		<description><![CDATA[Mettez vos prints de debug au placard, et apprenez à programmer debugger comme un homme, un vrai. Un homme qui n'a pas peur d'avoir un mug USB. Heu...]]></description>
				<content:encoded><![CDATA[<p>Mettre une série de <code>print</code> dans son programme a ses limites, et python possède nativement une excellente alternative.</p>
<p>Pour la plupart des langages, on utilise un debugger intégré dans un IDE ou un programme à part. Ou alors on se contente de fonctions telles que <code>var_dump</code> ou <code>print_r</code>. En Python, on utilise le module <code>pdb</code>.</p>
<p>Quand vous voulez savoir ce qui se passe à un endroit du programme, à la ligne précise où vous souhaitez explorer le problème, ajoutez à votre code :</p>

<div class="wp_syntax"><table><tr><td class="code"><pre class="python" style="font-family:monospace;"><span style="color: #ff7700;font-weight:bold;">import</span> <span style="color: #dc143c;">pdb</span><span style="color: #66cc66;">;</span> <span style="color: #dc143c;">pdb</span>.<span style="color: black;">set_trace</span><span style="color: black;">&#40;</span><span style="color: black;">&#41;</span></pre></td></tr></table></div>

<p>Et relancez votre programme <strong>depuis une console</strong>.</p>
<p>L&#8217;exécution du programme va alors se figer, et dans la console vous aurez accès à un shell special:</p>

<div class="wp_syntax"><table><tr><td class="code"><pre class="python" style="font-family:monospace;"><span style="color: black;">&#40;</span>Pdb<span style="color: black;">&#41;</span></pre></td></tr></table></div>

<h2>A quoi sert pdb</h2>
<p>Dans ce shell vous pouvez entrer deux choses:</p>
<ul>
<li>N&#8217;importe quelle expression Python qui tient sur une ligne.</li>
<li>Des commandes <code>pdb</code> speciales.</li>
</ul>
<p>Ce qui est génial, c&#8217;est que toute expression Python sera éxécutée dans le context de la ligne où le programme s&#8217;est arrêté.</p>
<p>Donc vous pouvez faire des <code>print</code>, des <code>if</code>, des <a href="http://sametmax.com/python-love-les-listes-en-intention-partie/">listes en intention</a>, bref, tous les tests que vous voulez, avec les variables du programme dans l&#8217;état où elles sont <strong>à ce moment là</strong>.</p>
<p>Vous avez accès à tout le code, y compris vos propres objets, classes et fonctions. En fait, vous avez même accès à l&#8217;import, et donc à toutes les librairies importables.</p>
<h2>L&#8217;essentiel des commandes</h2>
<p>En plus de pouvoir exécuter du Python, vous pouvez utiliser des commandes. Il y en a des nombreuses, mais vous pouvez tirer l&#8217;essentiel de <code>pdb</code> avec six d&#8217;entre elles:</p>
<ul>
<li> <code>l</code>: Liste quelques lignes de code avant et après là où vous vous trouver. Utile pour se resituer dans le contexte du programme. &#8216;l&#8217; pour &#8216;list&#8217;.</li>
<li> <code>n</code>: Exécute la ligne suivante. Vous pouvez ainsi continuer l&#8217;exécution du programme de bout en bout, ligne par ligne, et le tester en entier. &#8216;n&#8217; pour &#8216;next&#8217;.</li>
<li> <code>s</code>: Si votre ligne contient un appel de fonction ou de méthode, rentre dans à l&#8217;intérieur. &#8216;s&#8217; pour &#8216;step in&#8217;.</li>
<li> <code>r</code>: Si vous êtes dans une fonction ou une méthode, celà permet d&#8217;en sortir et de passer dans le scope du dessus. &#8216;r&#8217; pour &#8216;return&#8217;.</li>
<li><code>unt</code>: Si vous êtes à la dernière ligne d&#8217;une boucle, permet de reprendre l&#8217;exécution jusqu&#8217;à la sortie de la boucle. &#8216;unt&#8217; pour &#8216;until&#8217;.</li>
<li><code>q</code>: Quitte brutalement le programme en le faisant crasher. &#8216;q&#8217; pour &#8216;quit&#8217;.</li>
<li><code>c</code>: Quitte le debugger et continue l&#8217;exécution du programme normalement. Tous les changements que vous avez fait dans le code sont pris en compte. &#8216;c&#8217; pour &#8216;continue&#8217;.</li>
</ul>
<p>Pour utiliser une commande, il suffit de taper la lettre et d&#8217;appuyer sur <code>entrée</code>. Si vous appuyez sur <code>entrée</code> sans rien saisir, la commande précédente est exécutée, ce qui vous évitera de spammer le shell de commandes <code>n</code>.</p>
<h2>Les limites de pdb</h2>
<ul>
<li>Les commandes ont priorité sur le code Python. Vous ne pouvez donc pas assigner des variables dont le nom est en une seul lettre. C&#8217;est ennuyeux pour accéder à la variable &#8216;<code>i</code>&#8216; dans une boucle for. Dans ce cas, prefixez &#8216;<code>i</code>&#8216; par un &#8216;<code>!</code>&#8216; et il sera considéré comme du Python, et non comme une commande.</li>
<li>Si vous mettez <code>set_trace</code> dans une boucle, le debugger va se lancer à chaque tour de boucle, ce qui embrouille tout. Dans ce cas, et dans tous les cas où vous voulez que le debugger se lance à un moment particulier, utilisez un <code>if</code> ou un <code>try/except</code> pour que <code>set_trace</code> ne soit appelé que dans un cas précis.</li>
<li>Dans le cas de threads, de processus séparés, ou quand vous n&#8217;avez pas accès à <code>stdout</code>, <code>pdb</code> ne peut rien pour vous. Dans ce cas, le module <a href="http://docs.python.org/library/logging.html?highlight=logging#logging">logging</a> est votre ami.</li>
</ul>
<h2>pdb + ipython = ipdb</h2>
<p>Si vous êtes fan d&#8217;<a href="http://ipython.org/">ipython</a>, un coup de <a href="http://sametmax.com/votre-python-aime-les-pip/">pip</a>:</p>

<div class="wp_syntax"><table><tr><td class="code"><pre class="bash" style="font-family:monospace;">pip <span style="color: #c20cb9; font-weight: bold;">install</span> ipdb</pre></td></tr></table></div>

<p>Et ensuite dans le programme:</p>

<div class="wp_syntax"><table><tr><td class="code"><pre class="python" style="font-family:monospace;"><span style="color: #ff7700;font-weight:bold;">import</span> ipdb<span style="color: #66cc66;">;</span> ipdb.<span style="color: black;">set_trace</span><span style="color: black;">&#40;</span><span style="color: black;">&#41;</span></pre></td></tr></table></div>

<p>Vous aurez alors accès au shell de <code>pdb</code>, mais avec en prime les commandes et l&#8217;autocompletion d&#8217;ipython</p>
<h2>Mettre un break point programmatiquement en javascript</h2>
<p>Dans une moindre mesure, on peut aussi lancer un shell de debug depuis javascript. Ouvrez votre fenêtre d&#8217;outils Web intégrés au navigateur, Firebug ou équivalent.</p>
<p>Normalement il faut trouver votre script, puis la ligne, et mettre un break point.</p>
<p>Mais dans les navigateurs récents, vous pouvez juste ajouter:</p>

<div class="wp_syntax"><table><tr><td class="code"><pre class="javascript" style="font-family:monospace;"><span style="color: #FF0000;">debugger</span><span style="color: #339933;">;</span></pre></td></tr></table></div>

<p>A la ligne voulue, et recharger la page. Votre outil de debuggage se mettra au break point automatiquement</p>
]]></content:encoded>
			<wfw:commentRss>http://sametmax.com/debugger-en-python-les-bases-de-pdb/feed/</wfw:commentRss>
		<slash:comments>4</slash:comments>
	<enclosure url="http://sametmax.com/wp-content/uploads/2012/05/snake-golf-ball.jpg" length="51992" type="image/jpg" />	</item>
	</channel>
</rss>
